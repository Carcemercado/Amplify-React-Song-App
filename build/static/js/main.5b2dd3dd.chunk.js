(this["webpackJsonpamplify-song-app"]=this["webpackJsonpamplify-song-app"]||[]).push([[0],{219:function(e,n,t){},221:function(e,n,t){},246:function(e,n){},303:function(e,n,t){var a={"./amplify-amazon-button_5.entry.js":[318,16],"./amplify-auth-container.entry.js":[319,17],"./amplify-auth-fields_9.entry.js":[320,18],"./amplify-authenticator.entry.js":[321,5],"./amplify-button_3.entry.js":[322,19],"./amplify-chatbot.entry.js":[323,4],"./amplify-checkbox.entry.js":[324,20],"./amplify-confirm-sign-in_7.entry.js":[325,6],"./amplify-container.entry.js":[326,21],"./amplify-federated-buttons_2.entry.js":[327,22],"./amplify-federated-sign-in.entry.js":[328,23],"./amplify-form-field_4.entry.js":[329,24],"./amplify-greetings.entry.js":[330,25],"./amplify-icon-button.entry.js":[331,26],"./amplify-icon.entry.js":[332,7],"./amplify-link.entry.js":[333,27],"./amplify-nav_2.entry.js":[334,28],"./amplify-photo-picker.entry.js":[335,29],"./amplify-picker.entry.js":[336,30],"./amplify-radio-button_3.entry.js":[337,8],"./amplify-s3-album.entry.js":[338,9],"./amplify-s3-image-picker.entry.js":[339,10],"./amplify-s3-image.entry.js":[340,11],"./amplify-s3-text-picker.entry.js":[341,12],"./amplify-s3-text.entry.js":[342,13],"./amplify-select-mfa-type.entry.js":[343,31],"./amplify-sign-in-button.entry.js":[344,14],"./amplify-tooltip.entry.js":[345,32]};function i(e){if(!t.o(a,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=a[e],i=n[0];return t.e(n[1]).then((function(){return t(i)}))}i.keys=function(){return Object.keys(a)},i.id=303,e.exports=i},310:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t.n(a),r=t(64),s=t.n(r),c=(t(219),t(68)),o=t(28),l=t(58),u=t.n(l),p=t(99),j=t(14),d=(t.p,t(221),{aws_project_region:"us-east-1",aws_cognito_identity_pool_id:"us-east-1:9a950882-622c-4317-8eec-2898418c00ae",aws_cognito_region:"us-east-1",aws_user_pools_id:"us-east-1_wJnrc79Eh",aws_user_pools_web_client_id:"5vc4k2q1fak5kb8ostgmo8mq88",oauth:{},aws_cognito_login_mechanisms:["EMAIL"],aws_cognito_signup_attributes:["EMAIL"],aws_cognito_mfa_configuration:"OFF",aws_cognito_mfa_types:["SMS"],aws_cognito_password_protection_settings:{passwordPolicyMinLength:8,passwordPolicyCharacters:[]},aws_cognito_verification_mechanisms:["EMAIL"],aws_appsync_graphqlEndpoint:"https://kamgsqvzl5akbeeqypnh2v5o5q.appsync-api.us-east-1.amazonaws.com/graphql",aws_appsync_region:"us-east-1",aws_appsync_authenticationType:"AMAZON_COGNITO_USER_POOLS",aws_user_files_s3_bucket:"songstorage115046-dev",aws_user_files_s3_bucket_region:"us-east-1"}),f=t(406),b=t(409),g=t(178),y=t.n(g),m=t(179),h=t(122),O=t(174),_=t(308),x=t(410),v=t(405),w=t(404),k=t(190),S=t.n(k),C=t(191),A=t.n(C),$=t(189),N=t.n($),P=t(192),I=t.n(P),M=t(193),T=t.n(M),q=t(407),E=t(4);m.default.configure(d);var L=Object(b.a)((function(){var e=Object(a.useState)([]),n=Object(j.a)(e,2),t=n[0],i=n[1],r=Object(a.useState)(""),s=Object(j.a)(r,2),c=s[0],l=s[1],d=Object(a.useState)(""),b=Object(j.a)(d,2),g=b[0],m=b[1],w=Object(a.useState)(!1),k=Object(j.a)(w,2),C=k[0],$=k[1];Object(a.useEffect)((function(){M()}),[]);var P=function(){var e=Object(p.a)(u.a.mark((function e(n){var a,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c!==n){e.next=3;break}return l(""),e.abrupt("return");case 3:return a=t[n].filePath,e.prev=4,e.next=7,h.a.get(a,{expires:60});case 7:return i=e.sent,console.log("access url",i),l(n),m(i),e.abrupt("return");case 14:e.prev=14,e.t0=e.catch(4),console.error("error accessing the file from s3",e.t0),m(""),l("");case 19:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(n){return e.apply(this,arguments)}}(),M=function(){var e=Object(p.a)(u.a.mark((function e(){var n,t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.graphql(Object(_.b)("\n  query ListSongs(\n    $filter: ModelSongFilterInput\n    $limit: Int\n    $nextToken: String\n  ) {\n    listSongs(filter: $filter, limit: $limit, nextToken: $nextToken) {\n      items {\n        id\n        title\n        description\n        filePath\n        likes\n        owner\n        createdAt\n        updatedAt\n      }\n      nextToken\n    }\n  }\n"));case 3:n=e.sent,t=n.data.listSongs.items,console.log("song list",t),i(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("error on fetching songs",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(p.a)(u.a.mark((function e(n){var a,r,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(a=t[n]).likes=a.likes+1,delete a.createdAt,delete a.updatedAt,e.next=7,O.a.graphql(Object(_.b)("\n  mutation UpdateSong(\n    $input: UpdateSongInput!\n    $condition: ModelSongConditionInput\n  ) {\n    updateSong(input: $input, condition: $condition) {\n      id\n      title\n      description\n      filePath\n      likes\n      owner\n      createdAt\n      updatedAt\n    }\n  }\n",{input:a}));case 7:r=e.sent,(s=Object(o.a)(t))[n]=r.data.updateSong,i(s),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("error on adding like to songs",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(n){return e.apply(this,arguments)}}();return Object(E.jsxs)("div",{className:"App",children:[Object(E.jsxs)("header",{className:"App-header",children:[Object(E.jsx)(f.d,{}),Object(E.jsx)("h2",{children:"My Song App Content"})]}),Object(E.jsxs)("div",{className:"songList",children:[t.map((function(e,n){return Object(E.jsxs)(x.a,{variant:"outlined",elevation:2,children:[Object(E.jsxs)("div",{className:"songCard",children:[Object(E.jsx)(v.a,{"aria-label":"play",onClick:function(){return P(n)},children:c===n?Object(E.jsx)(N.a,{}):Object(E.jsx)(S.a,{})}),Object(E.jsxs)("div",{children:[Object(E.jsx)("div",{className:"songTitle",children:e.title}),Object(E.jsx)("div",{className:"songOwner",children:e.owner})]}),Object(E.jsxs)("div",{children:[Object(E.jsx)(v.a,{"aria-label":"like",onClick:function(){return T(n)},children:Object(E.jsx)(A.a,{})}),e.likes]}),Object(E.jsx)("div",{className:"songDescription",children:e.description})]}),c===n?Object(E.jsx)("div",{className:"ourAudioPlayer",children:Object(E.jsx)(y.a,{url:g,controls:!0,playing:!0,height:"50px",onPause:function(){return P(n)}})}):null]},"song".concat(n))})),C?Object(E.jsx)(F,{onUpload:function(){$(!1),M()}}):Object(E.jsx)(v.a,{onClick:function(){return $(!0)},children:Object(E.jsx)(I.a,{})})]})]})})),F=function(e){var n=e.onUpload,t=Object(a.useState)({}),i=Object(j.a)(t,2),r=i[0],s=i[1],o=Object(a.useState)(""),l=Object(j.a)(o,2),d=l[0],f=l[1],b=function(){var e=Object(p.a)(u.a.mark((function e(){var t,a,i,s,c,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("songData",r),t=r.title,a=r.owner,i=r.description,e.next=4,h.a.put("".concat(Object(q.a)(),".mp3"),d,{contentType:"audio/mp3"});case 4:return s=e.sent,c=s.key,o={id:Object(q.a)(),title:t,owner:a,description:i,filePath:c,like:0},e.next=9,O.a.graphql(Object(_.b)("\n  mutation CreateSong(\n    $input: CreateSongInput!\n    $condition: ModelSongConditionInput\n  ) {\n    createSong(input: $input, condition: $condition) {\n      id\n      title\n      description\n      filePath\n      likes\n      owner\n      createdAt\n      updatedAt\n    }\n  }\n",{input:o}));case 9:n();case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)("div",{className:"newSong",children:[Object(E.jsx)(w.a,{label:"Title",value:r.title,onChange:function(e){return s(Object(c.a)(Object(c.a)({},r),{},{title:e.target.value}))}}),Object(E.jsx)(w.a,{label:"Artist",value:r.owner,onChange:function(e){return s(Object(c.a)(Object(c.a)({},r),{},{owner:e.target.value}))}}),Object(E.jsx)(w.a,{label:"Description",value:r.description,onChange:function(e){return s(Object(c.a)(Object(c.a)({},r),{},{description:e.target.value}))}}),Object(E.jsx)("input",{type:"file",accept:"audio/mp3",onChange:function(e){return f(e.target.files[0])}}),Object(E.jsx)(v.a,{onClick:b,children:Object(E.jsx)(T.a,{})})]})},U=function(e){e&&e instanceof Function&&t.e(35).then(t.bind(null,423)).then((function(n){var t=n.getCLS,a=n.getFID,i=n.getFCP,r=n.getLCP,s=n.getTTFB;t(e),a(e),i(e),r(e),s(e)}))};s.a.render(Object(E.jsx)(i.a.StrictMode,{children:Object(E.jsx)(L,{})}),document.getElementById("root")),U()}},[[310,2,3]]]);
//# sourceMappingURL=main.5b2dd3dd.chunk.js.map